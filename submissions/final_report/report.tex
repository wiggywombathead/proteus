\documentclass[10pt,a4paper]{article}

\bibliographystyle{ieeetr}

\usepackage{lipsum}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{subfig}
\usepackage{amsmath}
\usepackage{url}
\usepackage{pgfgantt}
\usepackage{hyperref}
\usepackage{pdfpages}
\usepackage[title]{appendix}
\usepackage{listings}

\lstdefinelanguage{ARMasm}{
    morekeywords={
        and,
        bne,
        cmp,
        mov,
        mrc,
        orr,
    },
    sensitive=false,
    morecomment=[s]{/*}{*/},
    morecomment=[l]//,
}

\lstdefinestyle{asm}{
    belowcaptionskip=1\baselineskip,
    breaklines=true,
    %frame=L,
    xleftmargin=\parindent,
    language=C,
    showstringspaces=false,
    basicstyle=\ttfamily,
    keywordstyle=\bfseries\color{green!40!black},
    commentstyle=\itshape\color{purple!40!black},
    %identifierstyle=\color{blue},
    identifierstyle=\color{black},
    stringstyle=\color{orange},
}

\lstdefinestyle{customasm}{
    belowcaptionskip=1\baselineskip,
    language={ARMasm},
    %frame=L,
    %xleftmargin=\parindent,
    language=[ARMasm]Assembler,
    basicstyle=\footnotesize\ttfamily,
    commentstyle=\itshape\color{purple!40!black},
    identifierstyle=\color{black},
}

%\newcommand{\includecode}[2][c]{\lstinputlisting[caption=#2, escapechar=, style=custom#1]{#2}<!---->}
\newcommand{\includecode}[2][c]{\lstinputlisting[escapechar=, style=custom#1]{#2}<!---->}

\graphicspath{{./figs/}}

\def\HOME{../..}
\def\KSRC{\HOME/src/kernel}
\def\CSRC{\HOME/src/common}
\def\KHEAD{\HOME/include/kernel}
\def\CHEAD{\HOME/include/common}

% No section numbering
% \setcounter{secnumdepth}{0}

\providecommand{\keywords}[1]{\textbf{\textit{Keywords --}} #1}
\newcommand{\code}[1]{\texttt{#1}}

\begin{document}

\begin{titlepage}
    \begin{center}

        \vspace*{2cm}
        \includegraphics[width=.25\textwidth]{crest.png}

        \vspace*{1cm}
        {\Large \textbf{An Educational Kernel for the Raspberry Pi}} \\

        \vspace*{1cm}
        \textbf{Thomas Archbold} \\
        1602581 \\
        Department of Computer Science \\
        University of Warwick \\~\\

        April 29, 2019 \\~\\

        CS310 Third-year Project \\
        supervised by Adam Chester \\~\\

        \vfill

    \end{center}
\end{titlepage}

% abstract
\input{sections/abstract}

\keywords{operating systems, kernel, Raspberry Pi, process scheduling,
inter-process communication}

\pagebreak
\tableofcontents
\pagebreak

%\listoffigures
%\listoftables

% introduction
% background
% motivational material

% main body:
%   design
%   methodology
%   development
%   results
%   testing
%   evaluation

% Author's Assessment of the Project
%   technical contribution of project
%   why considered relevant and important
%   how can others use it
%   why should it be considered an achievement
%   limitations of the project

\input{sections/introduction}
\input{sections/background}
\input{sections/design}
\input{sections/implementation}
\input{sections/testing}
\input{sections/evaluation}

\bibliography{bibliography}

\begin{appendices}

    \section{Source code}
    \section{Timetable}
        \label{app:timetable}

    %\includecode{\KSRC/atag.c}
    %\includecode{\KSRC/gpio.c}
    %\includecode{\KSRC/gpu.c}
    %\includecode{\KSRC/interrupt.c}
    %\includecode{\KSRC/kbd.c}
    %\includecode{\KSRC/kernel.c}
    %\includecode{\KSRC/mailbox.c}
    %\includecode{\KSRC/memory.c}
    %\includecode{\KSRC/mmu.c}
    %\includecode{\KSRC/proc.c}
    %\includecode{\KSRC/sched.c}
    %\includecode{\KSRC/shm.c}
    %\includecode{\KSRC/timer.c}

    %\lstlistoflistings

    %\lstinputlisting[language=C]{\HOME/src/kernel/kernel.c}
%
%    \pagenumbering{gobble}


%
%    % Revised Timetable
%    \includepdf[landscape=true,pages=1,pagecommand={\section{Revised Timetable}}]{timetable/timetable.pdf}
%    \includepdf[landscape=true,pages=2,pagecommand={}]{timetable/timetable.pdf}

%    % Project Specification
%    \includepdf[pages=1,pagecommand={\section{Project Specification}}]{../specification/specification.pdf}
%    \includepdf[pages=2-6,pagecommand={}]{../specification/specification.pdf}
%    \includepdf[landscape=true,pages=7-,pagecommand={}]{../specification/specification.pdf}
%
\end{appendices}

\end{document}
